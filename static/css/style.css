/* ==========================================================================
   Inventory Intelligence — UI System (Compact + Unified Filters) — FINAL
   ==========================================================================
   - Explicit light/dark tokens via [data-theme] + prefers-color-scheme fallback
   - One source of truth for filter/pill sizing (height, radius, font, padding)
   - Consistent buttons (no "tile" explosions), compact pagination
   - Accessible focus rings, reduced motion support, high-contrast tweaks
   - All original hooks kept (#ids, .classes) so your JS keeps working
/* ======================================================================= */

/* ----- Baseline reset & a11y helpers ---------------------------------- */
*, *::before, *::after { box-sizing: border-box; }
html, body { height: 100%; }
:where(img, svg, video, canvas) { max-width: 100%; height: auto; }
:where(button, input, select, textarea) { font: inherit; color: inherit; }
:where(a) { color: inherit; text-decoration: none; }
:where([hidden]) { display: none !important; }
:root { color-scheme: light dark; }

/* Visible focus only when keyboarding */
:focus { outline: none; }
:focus-visible {
  outline: 2px solid color-mix(in oklab, var(--accent), #fff 8%);
  outline-offset: 2px;
}

/* Accessible skip link */
.skip-link {
  position: absolute; left: -9999px; top: -9999px;
}
.skip-link:focus-visible {
  left: var(--s-4); top: var(--s-4);
  background: var(--accent); color: var(--accent-contrast);
  padding: var(--s-2) var(--s-3); border-radius: var(--radius-sm); z-index: 9999;
}

/* ----- Design tokens --------------------------------------------------- */
:root {
  /* Palette (semantic) */
  --bg: #0b0d10;
  --surface: #101419;
  --surface-2: #121821;
  --text: #e6e8eb;
  --muted: #aab3bd;
  --border: #243042;
  --accent: #4ea1ff;
  --accent-contrast: #06131f;

  /* Status palette */
  --c-green: #2e7d32;
  --c-amber: #ef6c00;
  --c-red: #c62828;
  --c-grey: #607d8b;
  --c-blue: #0d6efd;
  --c-violet: #7e57c2;

  /* Typography */
  --font-sans: Inter, ui-sans-serif, system-ui, "Segoe UI", Roboto, Helvetica, Arial,
               "Apple Color Emoji", "Segoe UI Emoji";
  --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  --font-size: 14px;
  --line: 1.5;

  /* Layout / radius / shadow */
  --radius: 12px;
  --radius-sm: 8px;
  --shadow-sm: 0 1px 2px rgba(0,0,0,.15);
  --shadow-md: 0 6px 20px rgba(0,0,0,.18);

  /* Spacing */
  --s-1: 4px;
  --s-2: 8px;
  --s-3: 12px;
  --s-4: 16px;
  --s-5: 24px;
  --s-6: 32px;
  --s-7: 40px;

  /* Filter/controls (single source of truth) */
  --filter-h: 34px;
  --filter-radius: 12px;
  --filter-font: 0.68rem;
  --filter-pad-x: 12px;
  --filter-bg: var(--surface);
  --filter-bd: var(--border);
  --filter-focus: 0 0 0 2px color-mix(in oklab, var(--accent), transparent 75%);

  /* Bulk Update density */
  --bu-thumb: 36px;
  --bu-input-font: 0.66em;
  --bu-input-h: 22px;

  /* Pagination */
  --pg-h: 26px;
  --pg-font: 0.60rem;
  --pg-pad-x: 10px;
}

/* Optional explicit theme switch via [data-theme] */
/* Dark (default) is already set in :root */
:root[data-theme="light"] {
  --bg: #f6f8fa;
  --surface: #ffffff;
  --surface-2: #f2f4f7;
  --text: #0b0d10;
  --muted: #5b6b7d;
  --border: #d9e0e8;
  --accent: #0d6efd;
  --accent-contrast: #ffffff;
}

/* Respect user preference if no explicit [data-theme] set */
@media (prefers-color-scheme: light) {
  :root:not([data-theme="dark"]) {
    --bg: #f6f8fa;
    --surface: #ffffff;
    --surface-2: #f2f4f7;
    --text: #0b0d10;
    --muted: #5b6b7d;
    --border: #d9e0e8;
    --accent: #0d6efd;
    --accent-contrast: #ffffff;
  }
}

/* High contrast / reduced motion */
@media (prefers-reduced-motion: reduce) {
  * { animation: none !important; transition: none !important; scroll-behavior: auto !important; }
}
@media (prefers-contrast: more) {
  :root { --border: color-mix(in oklab, var(--text), #000 15%); }
}

/* ----- Base ------------------------------------------------------------ */
body {
  background: var(--bg);
  color: var(--text);
  font-family: var(--font-sans);
  font-size: var(--font-size);
  line-height: var(--line);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ----- Layout ---------------------------------------------------------- */
.app-layout {
  display: grid;
  grid-template-columns: 260px 1fr;
  min-height: 100vh;
}
.sidebar {
  background: var(--surface-2);
  border-right: 1px solid var(--border);
  padding: var(--s-5) var(--s-4);
  position: sticky; top: 0; align-self: start; height: 100vh; overflow: auto;
}
.sidebar .brand { font-weight: 700; margin-bottom: var(--s-5); }
.sidebar nav ul { list-style: none; padding: 0; margin: 0; display: grid; gap: 6px; }
.sidebar nav a {
  display: block; padding: 10px 12px; border-radius: 10px; color: var(--text); border: 1px solid transparent;
}
.sidebar nav a:hover { background: var(--surface); border-color: var(--border); }
.sidebar nav a.active { background: var(--accent); color: var(--accent-contrast); border-color: transparent; }

.main-content { padding: var(--s-6); display: grid; gap: var(--s-6); }

.container { max-width: 1080px; margin: 0 auto; }
.container-fluid { width: 100%; }

.page-header h1 { margin-bottom: 2px; }
.page-header h2 { color: var(--muted); font-weight: 500; }

/* ----- Cards & grids --------------------------------------------------- */
.card {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius); padding: var(--s-5); box-shadow: var(--shadow-sm);
}
.card header { margin-bottom: var(--s-3); }
.cards-grid { display: grid; gap: var(--s-5); grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }

.metrics-grid { display: grid; gap: var(--s-4); grid-template-columns: repeat(auto-fit, minmax(170px, 1fr)); }
.metric {
  background: var(--surface); border: 1px dashed var(--border);
  border-radius: var(--radius-sm); padding: var(--s-3);
}
.metric strong { font-size: 13px; color: var(--muted); }
.metric .value { font-size: 18px; font-weight: 700; }

/* ----- Controls (Unified filter style) -------------------------------- */
.controls-grid {
  display: grid; gap: var(--s-3);
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  align-items: center; /* baseline consistent */
  font-size: var(--filter-font);
  row-gap: 0.5rem;
}

/* Base chip/select look */
.controls-grid input[type="search"],
.controls-grid input[type="text"],
.controls-grid input[type="number"],
.controls-grid input[type="date"],
.controls-grid select,
.controls-grid .dropdown > summary {
  height: var(--filter-h); min-height: var(--filter-h);
  border-radius: var(--filter-radius);
  padding: 0 var(--filter-pad-x);
  font-size: var(--filter-font); line-height: 1.1;
  background: var(--filter-bg); border: 1px solid var(--filter-bd);
}

/* Show magnifier + prevent overlap where used */
.controls-grid .control { position: relative; display: block; }
.controls-grid .control .icon {
  position: absolute; left: 10px; top: 50%; transform: translateY(-50%);
  pointer-events: none; width: 16px; height: 16px;
}
.controls-grid .control input[type="search"] {
  padding-left: calc(var(--filter-pad-x) + 18px) !important;
}

/* Dropdown panel */
.dropdown[open] > summary {
  border-color: color-mix(in oklab, var(--accent), var(--filter-bd) 60%);
  box-shadow: var(--filter-focus);
}
.dropdown[open] > ul {
  position: absolute; z-index: 1000; top: 100%; left: 0; margin-top: 0.25rem; padding: 0.6rem;
  background: var(--surface) !important; border: 1px solid var(--border);
  border-radius: var(--radius); box-shadow: var(--shadow-md);
  width: max-content; min-width: 200px; max-height: 300px; overflow-y: auto;
  font-size: var(--filter-font);
}
.dropdown li label { padding: 0.2rem; display: block; }
.dropdown input[type="radio"], .dropdown input[type="checkbox"] { margin-right: 0.5em; }

/* Numeric inputs neutral spin buttons */
input[type="number"] { -moz-appearance: textfield; }
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }

/* Datepicker polish */
.controls-grid input[type="date"] { appearance: none; -webkit-appearance: none; }
.controls-grid input[type="date"]::-webkit-calendar-picker-indicator { opacity: .85; }

/* Columns button styled as a chip */
#column-visibility-button {
  height: var(--filter-h); font-size: var(--filter-font);
  border-radius: var(--filter-radius); padding: 0 var(--filter-pad-x);
  background: var(--filter-bg); border: 1px solid var(--filter-bd); color: inherit;
}
#column-visibility-button .icon { width: 16px; height: 16px; }

/* Dashboard v2 scope: keep search icon hidden + padding corrected */
section.controls-grid:has(#financial-status-filter) .control .icon { display: none !important; }
section.controls-grid:has(#financial-status-filter) .control input[type="search"] {
  padding-left: var(--filter-pad-x) !important;
}

/* ----- Buttons --------------------------------------------------------- */
button { gap: 8px; display: inline-flex; align-items: center; justify-content: center; }
button.secondary.outline { border-style: dashed; }
#export-button, #reset-filters,
#save-changes-btn,
#sync-all-orders-btn, #sync-all-products-btn, #sync-single-store-btn, #sync-date-range-btn,
#import-excel-btn {
  display: inline-flex !important; align-items: center; gap: .5rem;
  height: var(--filter-h) !important; padding: 0 var(--filter-pad-x) !important;
  font-size: var(--filter-font) !important; border-radius: var(--filter-radius) !important;
  max-width: max-content;
}
#export-button .icon,
#sync-all-orders-btn .icon, #sync-all-products-btn .icon, #sync-single-store-btn .icon, #sync-date-range-btn .icon {
  width: 16px; height: 16px;
}

/* File input + Import aligned and same height */
.import-controls {
  display: grid; grid-template-columns: minmax(300px, max-content) auto;
  gap: 0.75rem; align-items: center; justify-content: start;
}
.import-controls input[type="file"] { font-size: var(--filter-font); width: auto; max-width: 100%; white-space: nowrap; }
.import-controls input[type="file"]::file-selector-button {
  height: var(--filter-h); padding: 0 var(--filter-pad-x);
  font-size: var(--filter-font); border-radius: var(--filter-radius);
  background: var(--filter-bg); border: 1px solid var(--filter-bd);
}
#import-excel-btn { white-space: nowrap; }

/* ----- Toggle pill (for inventory group-by) ---------------------------- */
.toggle-pill { display: inline-flex; align-items: center; gap: 8px; width: fit-content; }
.toggle-pill input[type="checkbox"] { position: absolute; opacity: 0; width: 1px; height: 1px; }
.toggle-pill .slider {
  position: relative; width: 44px; height: 24px; border-radius: 999px;
  background: var(--border); transition: background .2s ease;
}
.toggle-pill .slider .knob {
  position: absolute; top: 2px; left: 2px; width: 20px; height: 20px; border-radius: 50%;
  background: var(--surface); box-shadow: 0 1px 3px rgba(0,0,0,.2); transition: transform .2s ease;
}
.toggle-pill .slider.on { background: var(--accent); }
.toggle-pill .slider.on .knob { transform: translateX(20px); }

/* ----- Tables ---------------------------------------------------------- */
.table-wrap {
  overflow: auto; border-radius: var(--radius); border: 1px solid var(--border); background: var(--surface);
}
table { width: 100%; border-collapse: collapse; font-size: 13px; }
thead th {
  position: sticky; top: 0;
  background: color-mix(in oklab, var(--surface), #000 4%);
  border-bottom: 1px solid var(--border); z-index: 2;
}
th, td { padding: 6px 8px; border-bottom: 1px solid var(--border); vertical-align: middle; }
tbody tr:hover { background: color-mix(in oklab, var(--surface), #000 3%); }
tbody tr:nth-child(even) { background: color-mix(in oklab, var(--surface), #000 2%); }
td code, td .code { font-family: var(--font-mono); font-size: 12px; }
.number, td.num, th.num { text-align: right; font-variant-numeric: tabular-nums; }
.sticky-col { position: sticky; left: 0; z-index: 1; background: inherit; }

/* Sorting chevrons */
th[data-sort-by] {
  position: relative; padding-right: 1.5em !important; white-space: nowrap; cursor: pointer;
}
th[data-sort-by].asc::after, th[data-sort-by].desc::after {
  position: absolute; right: 0.5em; top: 50%; transform: translateY(-50%);
  font-size: 0.8em; color: var(--accent);
}
th[data-sort-by].asc::after { content: '▲'; }
th[data-sort-by].desc::after { content: '▼'; }

/* Pagination (Inventory + Orders) */
#orders-table-container + .pagination-controls button,
#inventory-table-container + .pagination-controls button {
  height: var(--pg-h); min-height: var(--pg-h);
  padding: 0 var(--pg-pad-x); font-size: var(--pg-font); border-radius: 10px;
}
#orders-table-container + .pagination-controls #page-indicator,
#inventory-table-container + .pagination-controls #page-indicator {
  font-size: calc(var(--pg-font) + 0.05rem);
}
.pagination-controls { align-items: center; grid-template-columns: 1fr auto 1fr; display: grid; }
.pagination-controls > :first-child { justify-self: start; }
.pagination-controls > :last-child  { justify-self: end; }
#page-indicator { justify-self: center; }

/* ----- Dialog ---------------------------------------------------------- */
dialog::backdrop { background: rgba(0,0,0,.55); }
dialog article {
  background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius);
}
button.close { --pico-icon-close: none; }
button.close::after {
  content: "✕"; display: inline-flex; align-items: center; justify-content: center;
  width: 28px; height: 28px; border-radius: 50%; border: 1px solid var(--border);
}

/* ----- Toast ----------------------------------------------------------- */
#toast {
  position: fixed; bottom: 20px; right: 20px; z-index: 50;
  background: var(--surface); color: var(--text);
  border: 1px solid var(--border); border-radius: var(--radius);
  padding: 10px 12px; box-shadow: var(--shadow-md); display: none;
}

/* ----- Charts & progress ---------------------------------------------- */
.chart-wrap { width: 100%; overflow: hidden; }
.progress-area .bar { height: 8px; background: var(--border); border-radius: 999px; overflow: hidden; }
.progress-area .bar > span { display: block; height: 100%; background: var(--accent); }

/* ----- Bulk Update (tighter + aligned) -------------------------------- */
.bulk-update-controls .controls-grid { align-items: end; }
#save-changes-btn { /* already normalized in Buttons block */ }

.bulk-update-table { table-layout: fixed; width: 100%; }
.bulk-update-table th, .bulk-update-table td {
  height: 26px; max-height: 26px; padding: 0.06rem 0.32rem; vertical-align: middle;
}
.bulk-update-table th { font-size: 0.72em; }
.bulk-update-table img {
  width: var(--bu-thumb); height: var(--bu-thumb); object-fit: cover; border-radius: var(--radius);
}
.bulk-update-table input[type="text"],
.bulk-update-table input[type="number"],
.bulk-update-table select {
  width: 100%; height: var(--bu-input-h);
  border: 1px solid transparent; background: transparent;
  padding: 0 0.25rem; font-size: calc(var(--bu-input-font) * 1.1); box-sizing: border-box;
}
.bulk-update-table input:focus, .bulk-update-table select:focus {
  border-color: var(--accent);
  background: color-mix(in oklab, var(--surface), #fff 4%);
}
.bulk-update-table input.changed, .bulk-update-table select.changed {
  background-color: color-mix(in oklab, #ffcc00, transparent 90%);
  font-weight: bold;
}
#bulk-apply-row input { font-size: 0.85em; font-style: italic; }

/* ----- Inventory numeric filters (share unified spec) ----------------- */
#min-retail-input, #max-retail-input, #min-inv-input, #max-inv-input {
  height: var(--filter-h); min-height: var(--filter-h);
  border-radius: var(--filter-radius);
  padding: 0 var(--filter-pad-x); font-size: var(--filter-font);
  background: var(--filter-bg); border: 1px solid var(--filter-bd);
}

/* ----- Utilities ------------------------------------------------------- */
.overflow-auto { overflow: auto; }
.inline { display: inline-flex; gap: 8px; align-items: center; }
.hint { cursor: help; font-weight: 700; padding-left: 6px; }
.controls-grid > * { width: 100%; max-width: 100%; }
.controls-grid button { width: max-content; }

/* ----- Responsive ------------------------------------------------------ */
@media (max-width: 1024px) {
  .app-layout { grid-template-columns: 1fr; }
  .sidebar { position: static; height: auto; border-right: none; border-bottom: 1px solid var(--border); }
  .sidebar nav ul { grid-auto-flow: column; grid-auto-columns: max-content; overflow: auto; }
  .main-content { padding: var(--s-5); }
}
@media (max-width: 640px) {
  .container, .container-fluid { padding: 0; }
  .controls-grid { grid-template-columns: 1fr 1fr; }
  .cards-grid { grid-template-columns: 1fr; }
}

/* ----- Status colors & badge ------------------------------------------ */
/* Financial */
.status-paid { color: var(--c-green); }
.status-authorized, .status-pending, .status-partially_paid { color: var(--c-amber); }
.status-refunded, .status-partially_refunded { color: var(--c-red); }
.status-voided { color: var(--c-grey); }
/* Fulfillment */
.status-fulfilled, .status-shipped { color: var(--c-green); }
.status-partially_fulfilled, .status-in_progress, .status-scheduled { color: var(--c-amber); }
.status-unfulfilled, .status-returned { color: var(--c-red); }
.status-restocked { color: var(--c-violet); }
.status-on_hold { color: var(--c-blue); }
.status-cancelled, .status-archived { color: var(--c-grey); }

/* Optional pill badge */
.status-badge {
  display: inline-block; padding: 0.12rem 0.45rem; border-radius: 999px; border: 1px solid currentColor;
  font-size: 0.68rem; font-weight: 600; letter-spacing: .01em;
  background: color-mix(in oklab, currentColor, transparent 90%);
}
/* ====================================================================== */
/* EXACT-MATCH FILTER LOOK: Inventory → Dashboard v2 + Bulk Update        */
/* ====================================================================== */

/* Dashboard v2: scope via presence of #financial-status-filter */
section.controls-grid:has(#financial-status-filter) input[type="search"],
section.controls-grid:has(#financial-status-filter) input[type="text"],
section.controls-grid:has(#financial-status-filter) input[type="number"],
section.controls-grid:has(#financial-status-filter) input[type="date"],
section.controls-grid:has(#financial-status-filter) select,
section.controls-grid:has(#financial-status-filter) .dropdown > summary {
  height: var(--filter-h) !important;
  min-height: var(--filter-h) !important;
  border-radius: var(--filter-radius) !important;
  padding: 0 var(--filter-pad-x) !important;
  font-size: var(--filter-font) !important;
  background: var(--filter-bg) !important;
  border: 1px solid var(--filter-bd) !important;
  line-height: 1.1 !important;
}

/* Show magnifier + correct padding like Inventory */
section.controls-grid:has(#financial-status-filter) .control .icon {
  display: block !important;
  width: 16px; height: 16px;
}
section.controls-grid:has(#financial-status-filter) .control input[type="search"] {
  padding-left: calc(var(--filter-pad-x) + 18px) !important;
}

/* Ensure Dashboard v2 dropdown panels match Inventory */
section.controls-grid:has(#financial-status-filter) .dropdown[open] > summary {
  border-color: color-mix(in oklab, var(--accent), var(--filter-bd) 60%) !important;
  box-shadow: 0 0 0 2px color-mix(in oklab, var(--accent), transparent 80%) !important;
}

/* Bulk Update: make all filter chips 1:1 with Inventory */
.bulk-update-controls .controls-grid input[type="search"],
.bulk-update-controls .controls-grid input[type="text"],
.bulk-update-controls .controls-grid input[type="number"],
.bulk-update-controls .controls-grid input[type="date"],
.bulk-update-controls .controls-grid select,
.bulk-update-controls .controls-grid .dropdown > summary {
  height: var(--filter-h) !important;
  min-height: var(--filter-h) !important;
  border-radius: var(--filter-radius) !important;
  padding: 0 var(--filter-pad-x) !important;
  font-size: var(--filter-font) !important;
  background: var(--filter-bg) !important;
  border: 1px solid var(--filter-bd) !important;
  line-height: 1.1 !important;
}

/* Bulk Update: search icon visible + padding identical to Inventory */
.bulk-update-controls .control .icon {
  position: absolute; left: 10px; top: 50%; transform: translateY(-50%);
  width: 16px; height: 16px; pointer-events: none; display: block !important;
}
.bulk-update-controls .control input[type="search"] {
  padding-left: calc(var(--filter-pad-x) + 18px) !important;
}

/* Bulk Update: primary actions same compact spec */
#save-changes-btn,
#import-excel-btn {
  height: var(--filter-h) !important;
  min-height: var(--filter-h) !important;
  font-size: var(--filter-font) !important;
  border-radius: var(--filter-radius) !important;
  padding: 0 var(--filter-pad-x) !important;
  line-height: 1.1 !important;
}

/* ====================================================================== */
/* PRODUCT DETAILS: shrink quick-range (7d/30d/90d) + Apply                */
/* ====================================================================== */

#pd-apply, #pd-7, #pd-30, #pd-90 {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: .45rem;
  height: var(--filter-h) !important;
  min-height: var(--filter-h) !important;
  padding: 0 var(--filter-pad-x) !important;
  font-size: var(--filter-font) !important;
  border-radius: var(--filter-radius) !important;
  line-height: 1.1 !important;
}

/* Optional: make the quick buttons slightly narrower on small screens */
@media (max-width: 640px) {
  #pd-7, #pd-30, #pd-90 { padding-inline: 10px !important; }
}

/* ====================================================================== */
/* MISC ALIGNMENT: keep column button and export/reset visually identical  */
/* ====================================================================== */

#column-visibility-button,
#export-button,
#reset-filters {
  height: var(--filter-h) !important;
  min-height: var(--filter-h) !important;
  font-size: var(--filter-font) !important;
  border-radius: var(--filter-radius) !important;
  padding: 0 var(--filter-pad-x) !important;
  line-height: 1.1 !important;
}
#export-button .icon { width: 16px; height: 16px; }

/* ========================= BULK UPDATE ========================= */
/* Red circle: make table content +10% */
#bulk-update-container .bulk-update-table td { font-size: 1.1em; }
#bulk-update-container .bulk-update-table th { font-size: calc(0.72em * 1.1); }

/* Also enlarge the editable "Apply…" fields */
#bulk-update-container .bulk-update-table input[type="text"],
#bulk-update-container .bulk-update-table input[type="number"],
#bulk-update-container .bulk-update-table select {
  font-size: 0.9rem !important; /* ~+10% vs before and readable inside 26px rows */
}

/* Yellow circle: center text vertically in all chips and remove search icon */
.bulk-update-controls .control .icon { display: none !important; }
.bulk-update-controls .control input[type="search"] {
  padding-left: var(--filter-pad-x) !important;
}
.bulk-update-controls .controls-grid input[type="search"],
.bulk-update-controls .controls-grid input[type="text"],
.bulk-update-controls .controls-grid input[type="number"],
.bulk-update-controls .controls-grid input[type="date"],
.bulk-update-controls .controls-grid select,
.bulk-update-controls .controls-grid .dropdown > summary {
  height: var(--filter-h) !important;
  min-height: var(--filter-h) !important;
  padding: 0 var(--filter-pad-x) !important;
  font-size: var(--filter-font) !important;
  border-radius: var(--filter-radius) !important;
  background: var(--filter-bg) !important;
  border: 1px solid var(--filter-bd) !important;
  line-height: 1.1 !important;
  display: inline-flex;          /* for summary */
  align-items: center;           /* vertical center */
  -webkit-appearance: none; appearance: none;
}

/* ========================= INVENTORY REPORT ========================= */
/* Remove the search icon and fix padding like you want */
section.controls-grid:has(#store-filter) .control .icon { display: none !important; }
section.controls-grid:has(#store-filter) .control input[type="search"] {
  padding-left: var(--filter-pad-x) !important;
}

/* ========================= PAGINATION ========================= */
.pagination-controls button {
  height: var(--pg-h) !important;
  min-height: var(--pg-h) !important;
  padding: 0 var(--pg-pad-x) !important;
  font-size: var(--pg-font) !important;
  border-radius: 10px !important;
  background: var(--surface) !important;
  border: 1px solid var(--border) !important;
  box-shadow: none !important;
}
.pagination-controls button::before,
.pagination-controls button::after { content: none !important; }
.pagination-controls .icon { width: 14px; height: 14px; }

/* ========================= ORDERS DASHBOARD (v2) ========================= */
/* Force exact Inventory chip look + alignment; hide search icon */
section.controls-grid:has(#financial-status-filter) input[type="search"],
section.controls-grid:has(#financial-status-filter) input[type="text"],
section.controls-grid:has(#financial-status-filter) input[type="number"],
section.controls-grid:has(#financial-status-filter) input[type="date"],
section.controls-grid:has(#financial-status-filter) select,
section.controls-grid:has(#financial-status-filter) .dropdown > summary {
  height: var(--filter-h) !important;
  min-height: var(--filter-h) !important;
  padding: 0 var(--filter-pad-x) !important;
  font-size: var(--filter-font) !important;
  border-radius: var(--filter-radius) !important;
  background: var(--filter-bg) !important;
  border: 1px solid var(--filter-bd) !important;
  line-height: 1.1 !important;
  display: inline-flex; align-items: center;
  -webkit-appearance: none; appearance: none;
}
section.controls-grid:has(#financial-status-filter) .control .icon { display: none !important; }
section.controls-grid:has(#financial-status-filter) .control input[type="search"] {
  padding-left: var(--filter-pad-x) !important;
}
section.controls-grid:has(#financial-status-filter) .dropdown[open] > summary {
  border-color: color-mix(in oklab, var(--accent), var(--filter-bd) 60%) !important;
  box-shadow: 0 0 0 2px color-mix(in oklab, var(--accent), transparent 80%) !important;
}

/* ========================= GENERAL FORM NORMALIZATION ========================= */
.controls-grid input[type="search"],
.controls-grid input[type="text"],
.controls-grid input[type="number"],
.controls-grid input[type="date"],
.controls-grid select {
  line-height: 1.1 !important;
  -webkit-appearance: none; appearance: none;
}
/* ===========================================================
   1) Pagination — +25% size, font, and width
   =========================================================== */
:root {
  --pg-h: 33px;          /* 26px → ~+25% */
  --pg-font: 0.75rem;    /* 0.60rem → +25% */
  --pg-pad-x: 14px;      /* 10px → a bit wider */
}
.pagination-controls button {
  height: var(--pg-h) !important;
  min-height: var(--pg-h) !important;
  padding: 0 var(--pg-pad-x) !important;
  font-size: var(--pg-font) !important;
  min-width: 140px;               /* make the buttons visibly wider */
}
.pagination-controls .icon { width: 16px; height: 16px; }

/* ===========================================================
   2) Orders Dashboard filters — remove icons and align text
   =========================================================== */
/* Hide all filter icons (search + summary funnels) in Dashboard v2 */
section.controls-grid:has(#financial-status-filter) .control .icon,
section.controls-grid:has(#financial-status-filter) summary .icon {
  display: none !important;
}
/* Correct inner padding now that icons are gone */
section.controls-grid:has(#financial-status-filter) .control input[type="search"] {
  padding-left: var(--filter-pad-x) !important;
}
/* Make the dashboard filter row expand nicely like Inventory */
section.controls-grid:has(#financial-status-filter) {
  display: grid !important;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)) !important;
  column-gap: var(--s-3);
  row-gap: .5rem;
}
section.controls-grid:has(#financial-status-filter) input[type="search"],
section.controls-grid:has(#financial-status-filter) input[type="date"],
section.controls-grid:has(#financial-status-filter) select,
section.controls-grid:has(#financial-status-filter) .dropdown > summary {
  display: inline-flex; align-items: center; /* perfect vertical alignment */
}

/* ===========================================================
   3) Bulk Update — widen filters / reduce big gaps
   =========================================================== */
/* Remove the search icon from "Filter by SKU…" */
.bulk-update-controls .control .icon { display: none !important; }
.bulk-update-controls .control input[type="search"] {
  padding-left: var(--filter-pad-x) !important;
}

/* Make the whole filter row auto-fill the width with wider chips */
.bulk-update-controls .controls-grid {
  display: grid !important;
  grid-template-columns: repeat(auto-fit, minmax(230px, 1fr)) !important;
  column-gap: var(--s-3);
  row-gap: .5rem;
}

/* Ensure every chip stretches consistently (including <summary> and fieldsets) */
.bulk-update-controls .controls-grid > *,
.bulk-update-controls .controls-grid details,
.bulk-update-controls .controls-grid .dropdown > summary,
.bulk-update-controls .controls-grid fieldset {
  width: 100%;
  min-width: 0;
}

/* Give the tiny "No Barcode" fieldset a real chip width so it doesn't leave a big hole */
.bulk-update-controls fieldset { min-width: 230px; }

/* Keep text centered vertically inside all Bulk Update chips */
.bulk-update-controls .controls-grid input[type="search"],
.bulk-update-controls .controls-grid input[type="text"],
.bulk-update-controls .controls-grid input[type="number"],
.bulk-update-controls .controls-grid input[type="date"],
.bulk-update-controls .controls-grid select,
.bulk-update-controls .controls-grid .dropdown > summary {
  display: inline-flex;
  align-items: center;
  height: var(--filter-h) !important;
  min-height: var(--filter-h) !important;
  padding: 0 var(--filter-pad-x) !important;
  font-size: var(--filter-font) !important;
  border-radius: var(--filter-radius) !important;
  background: var(--filter-bg) !important;
  border: 1px solid var(--filter-bd) !important;
  line-height: 1.1 !important;
}
/* ===================== DASHBOARD v2 ===================== */
/* Pack filters tighter and align the Columns button */
section.controls-grid:has(#financial-status-filter) {
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important; /* wider chips / fewer gaps */
  column-gap: var(--s-2) !important;  /* closer together */
  row-gap: .5rem !important;
}
section.controls-grid:has(#financial-status-filter) #column-visibility-button {
  display: inline-flex !important;
  align-items: center !important;
  height: var(--filter-h) !important;
  min-height: var(--filter-h) !important;
  padding: 0 var(--filter-pad-x) !important;
  font-size: var(--filter-font) !important;
  border-radius: var(--filter-radius) !important;
  margin: 0 !important; /* line up perfectly with chips */
}

/* ===================== BULK UPDATE ===================== */
/* A) Table: narrow image column, give space to Product + Barcode */
#bulk-update-container .bulk-update-table {
  table-layout: fixed;
}
#bulk-update-container .bulk-update-table th:nth-child(2),
#bulk-update-container .bulk-update-table td:nth-child(2) {
  /* just a bit wider than the thumbnail so it stops wasting space */
  width: calc(var(--bu-thumb) + 12px) !important;
  max-width: calc(var(--bu-thumb) + 12px) !important;
  padding-left: 4px; padding-right: 4px;
}
#bulk-update-container .bulk-update-table th:nth-child(5),
#bulk-update-container .bulk-update-table td:nth-child(5) {
  width: 30% !important; /* Product wider */
}
#bulk-update-container .bulk-update-table th:nth-child(6),
#bulk-update-container .bulk-update-table td:nth-child(6) {
  width: 18% !important; /* Barcode wider */
}

/* B) Only +5% text size in bulk edit table (not +10%) */
#bulk-update-container .bulk-update-table td { font-size: 1.05em !important; }
#bulk-update-container .bulk-update-table th { font-size: calc(0.72em * 1.05) !important; }
#bulk-update-container .bulk-update-table input[type="text"],
#bulk-update-container .bulk-update-table input[type="number"],
#bulk-update-container .bulk-update-table select {
  font-size: calc(var(--bu-input-font) * 1.05) !important;
}

/* C) Align No Barcode / Group by Barcode / file & import on one baseline */
.bulk-update-controls .controls-grid {
  align-items: center !important;  /* baseline alignment across the row */
}
.bulk-update-controls fieldset {
  border: 0; padding: 0; margin: 0;
}
.bulk-update-controls fieldset label {
  display: inline-flex; align-items: center; gap: .5rem;
  height: var(--filter-h); min-height: var(--filter-h);
  padding: 0 var(--filter-pad-x);
  border: 1px solid var(--filter-bd);
  border-radius: var(--filter-radius);
  background: var(--filter-bg);
  font-size: var(--filter-font);
}
.bulk-update-controls #group-toggle { margin: 0; } /* remove stray input offset */

.bulk-update-controls .import-controls {
  display: inline-flex !important;
  align-items: center !important;
  gap: .5rem;
}
.bulk-update-controls #save-changes-btn,
.bulk-update-controls #import-excel-btn,
.bulk-update-controls .import-controls input[type="file"]::file-selector-button {
  height: var(--filter-h) !important;
  min-height: var(--filter-h) !important;
  font-size: var(--filter-font) !important;
  border-radius: var(--filter-radius) !important;
}

/* D) Make Bulk Update filters fill width more (reduce gaps) */
.bulk-update-controls .controls-grid {
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)) !important;
  column-gap: var(--s-2) !important;
  row-gap: .5rem !important;
}
.bulk-update-controls .controls-grid > *,
.bulk-update-controls .controls-grid details,
.bulk-update-controls .controls-grid .dropdown > summary,
.bulk-update-controls .controls-grid fieldset { width: 100%; min-width: 0; }

/* E) In "Group by Barcode" view, make thumbnails 30% smaller */
.bulk-update-controls:has(#group-toggle:checked) ~ #bulk-update-container .bulk-update-table img {
  width: calc(var(--bu-thumb) * 0.7) !important;
  height: calc(var(--bu-thumb) * 0.7) !important;
}

/* F) Keep Bulk Update chips vertically centered */
.bulk-update-controls .controls-grid input[type="search"],
.bulk-update-controls .controls-grid input[type="text"],
.bulk-update-controls .controls-grid input[type="number"],
.bulk-update-controls .controls-grid input[type="date"],
.bulk-update-controls .controls-grid select,
.bulk-update-controls .controls-grid .dropdown > summary {
  display: inline-flex; align-items: center;
  height: var(--filter-h) !important; min-height: var(--filter-h) !important;
  padding: 0 var(--filter-pad-x) !important; line-height: 1.1 !important;
}

/* ===================== DASHBOARD v2 — tighter, wider chips ===================== */
section.controls-grid:has(#financial-status-filter) {
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)) !important; /* wider controls */
  column-gap: var(--s-2) !important; /* closer together */
  row-gap: .5rem !important;
}
section.controls-grid:has(#financial-status-filter) #column-visibility-button {
  display: inline-flex !important; align-items: center !important;
  height: var(--filter-h) !important; min-height: var(--filter-h) !important;
  padding: 0 var(--filter-pad-x) !important; font-size: var(--filter-font) !important;
  border-radius: var(--filter-radius) !important; margin: 0 !important;
}

/* ===================== BULK UPDATE — filters aligned & tighter ===================== */
.bulk-update-controls .controls-grid {
  align-items: center !important; /* same baseline for all */
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important; /* wider chips */
  column-gap: var(--s-2) !important; row-gap: .5rem !important;
}
.bulk-update-controls fieldset label {
  display: inline-flex; align-items: center; gap: .5rem;
  height: var(--filter-h); min-height: var(--filter-h);
  padding: 0 var(--filter-pad-x);
  border: 1px solid var(--filter-bd); border-radius: var(--filter-radius);
  background: var(--filter-bg); font-size: var(--filter-font);
}
.bulk-update-controls .import-controls {
  display: inline-flex !important; align-items: center !important; gap: .5rem;
}
.bulk-update-controls .import-controls input[type="file"] {
  height: var(--filter-h); display: inline-flex; align-items: center;
}
.bulk-update-controls .import-controls input[type="file"]::file-selector-button,
.bulk-update-controls #import-excel-btn,
.bulk-update-controls #save-changes-btn {
  height: var(--filter-h) !important; min-height: var(--filter-h) !important;
  font-size: var(--filter-font) !important; border-radius: var(--filter-radius) !important;
}

/* Remove search icon in Bulk Update filter and fix padding */
.bulk-update-controls .control .icon { display: none !important; }
.bulk-update-controls .control input[type="search"] { padding-left: var(--filter-pad-x) !important; }

/* ===================== BULK UPDATE — 30% smaller thumbs when grouped ===================== */
/* Use multiple :has() paths for robustness */
:root:has(#group-toggle:checked) #bulk-update-container .bulk-update-table img,
.bulk-update-controls:has(#group-toggle:checked) ~ #bulk-update-container .bulk-update-table img {
  width: calc(var(--bu-thumb) * 0.7) !important;
  height: calc(var(--bu-thumb) * 0.7) !important;
}
/* (Optional fallback: uncomment to make them always smaller)
#bulk-update-container .bulk-update-table img { width: calc(var(--bu-thumb)*0.7); height: calc(var(--bu-thumb)*0.7); }
*/

/* ===================== BULK UPDATE — column width & readability ===================== */
/* Fixed layout to respect widths */
#bulk-update-container .bulk-update-table { table-layout: fixed; }

/* 1) Checkbox column (1) */
#bulk-update-container .bulk-update-table th:nth-child(1),
#bulk-update-container .bulk-update-table td:nth-child(1) {
  width: 42px !important; max-width: 42px !important;
}

/* 2) Image column (2) — just a bit wider than the thumbnail */
#bulk-update-container .bulk-update-table th:nth-child(2),
#bulk-update-container .bulk-update-table td:nth-child(2) {
  width: calc(var(--bu-thumb) + 16px) !important;
  max-width: calc(var(--bu-thumb) + 16px) !important;
  padding-inline: 4px;
}

/* 3) Store (3) & SKU (4) — tighter but readable */
#bulk-update-container .bulk-update-table th:nth-child(3),
#bulk-update-container .bulk-update-table td:nth-child(3) { min-width: 110px !important; }
#bulk-update-container .bulk-update-table th:nth-child(4),
#bulk-update-container .bulk-update-table td:nth-child(4) { min-width: 150px !important; }

/* 4) Product (5) — give it real space */
#bulk-update-container .bulk-update-table th:nth-child(5),
#bulk-update-container .bulk-update-table td:nth-child(5) { min-width: 360px !important; }

/* 5) Barcode (6) — wider for full code */
#bulk-update-container .bulk-update-table th:nth-child(6),
#bulk-update-container .bulk-update-table td:nth-child(6) { min-width: 200px !important; }

/* 6) Type (7) & Status (8) — compact */
#bulk-update-container .bulk-update-table th:nth-child(7),
#bulk-update-container .bulk-update-table td:nth-child(7),
#bulk-update-container .bulk-update-table th:nth-child(8),
#bulk-update-container .bulk-update-table td:nth-child(8) { min-width: 120px !important; }

/* 7) Price (9) & Cost (10) — numeric, narrower */
#bulk-update-container .bulk-update-table th:nth-child(9),
#bulk-update-container .bulk-update-table td:nth-child(9),
#bulk-update-container .bulk-update-table th:nth-child(10),
#bulk-update-container .bulk-update-table td:nth-child(10) { min-width: 84px !important; }

/* 8) On Hand (11) & Available (12) — tighter */
#bulk-update-container .bulk-update-table th:nth-child(11),
#bulk-update-container .bulk-update-table td:nth-child(11),
#bulk-update-container .bulk-update-table th:nth-child(12),
#bulk-update-container .bulk-update-table td:nth-child(12) { min-width: 76px !important; }

/* Text size bump stays at +5% only for Bulk Update table */
#bulk-update-container .bulk-update-table td { font-size: 1.05em !important; }
#bulk-update-container .bulk-update-table th { font-size: calc(0.72em * 1.05) !important; }
#bulk-update-container .bulk-update-table input[type="text"],
#bulk-update-container .bulk-update-table input[type="number"],
#bulk-update-container .bulk-update-table select {
  font-size: calc(var(--bu-input-font) * 1.05) !important;
}

/* ========================= BULK UPDATE — columns & readability ========================= */
/* Keep fixed layout so widths are respected */
#bulk-update-container .bulk-update-table { table-layout: fixed; }

/* (1) Checkbox */
#bulk-update-container .bulk-update-table th:nth-child(1),
#bulk-update-container .bulk-update-table td:nth-child(1) {
  width: 42px !important; max-width: 42px !important;
}

/* (2) Image — just a hair bigger than the thumb */
#bulk-update-container .bulk-update-table th:nth-child(2),
#bulk-update-container .bulk-update-table td:nth-child(2) {
  width: calc(var(--bu-thumb) + 12px) !important;
  max-width: calc(var(--bu-thumb) + 12px) !important;
  padding-inline: 4px;
}

/* (3) Store — fixed width so names don’t bounce */
#bulk-update-container .bulk-update-table th:nth-child(3),
#bulk-update-container .bulk-update-table td:nth-child(3) {
  width: 150px !important;
  max-width: 150px !important;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

/* (4) SKU — WIDER + slightly larger font for readability */
#bulk-update-container .bulk-update-table th:nth-child(4),
#bulk-update-container .bulk-update-table td:nth-child(4) {
  width: 230px !important;        /* was ~150px before */
  max-width: 230px !important;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
#bulk-update-container .bulk-update-table td:nth-child(4) {
  font-size: 1.10em !important;   /* bump just SKU text (+~10%) */
}

/* (5) Product — let it breathe; takes remaining flexible space */
#bulk-update-container .bulk-update-table th:nth-child(5),
#bulk-update-container .bulk-update-table td:nth-child(5) {
  min-width: 380px !important;    /* gives Product more room if available */
}

/* (6) Barcode — tighten; free space for SKU/Product */
#bulk-update-container .bulk-update-table th:nth-child(6),
#bulk-update-container .bulk-update-table td:nth-child(6) {
  width: 160px !important;        /* down from ~200px */
  max-width: 160px !important;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  font-variant-numeric: tabular-nums;
}

/* (7) Type & (8) Status — compact but steady */
#bulk-update-container .bulk-update-table th:nth-child(7),
#bulk-update-container .bulk-update-table td:nth-child(7),
#bulk-update-container .bulk-update-table th:nth-child(8),
#bulk-update-container .bulk-update-table td:nth-child(8) {
  width: 120px !important; max-width: 120px !important;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

/* (9) Price & (10) Cost — small numeric cells */
#bulk-update-container .bulk-update-table th:nth-child(9),
#bulk-update-container .bulk-update-table td:nth-child(9),
#bulk-update-container .bulk-update-table th:nth-child(10),
#bulk-update-container .bulk-update-table td:nth-child(10) {
  width: 90px !important; max-width: 90px !important;
}

/* (11) On Hand & (12) Available — tighter */
#bulk-update-container .bulk-update-table th:nth-child(11),
#bulk-update-container .bulk-update-table td:nth-child(11),
#bulk-update-container .bulk-update-table th:nth-child(12),
#bulk-update-container .bulk-update-table td:nth-child(12) {
  width: 82px !important; max-width: 82px !important;
}

/* Keep the general +5% table bump we added earlier (no change needed) */

/* ========================= BULK UPDATE — filter alignment (baseline & spacing) ========================= */
.bulk-update-controls .controls-grid {
  align-items: center !important;                             /* vertical alignment */
  grid-auto-flow: row dense;                                  /* fill gaps tightly */
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important;
  column-gap: var(--s-2) !important;                          /* closer spacing */
  row-gap: .5rem !important;
}

/* ========================= DASHBOARD v2 — tighter packing & datepickers same row ========================= */
section.controls-grid:has(#financial-status-filter) {
  grid-auto-flow: row dense;                                  /* fills holes so items settle on same row */
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)) !important; /* slightly smaller min to fit more per row */
  column-gap: var(--s-1) !important;                          /* bring filters closer together */
  row-gap: .5rem !important;
}
/* Keep Columns button visually aligned with the same chip spec */
section.controls-grid:has(#financial-status-filter) #column-visibility-button {
  height: var(--filter-h) !important; min-height: var(--filter-h) !important;
  padding: 0 var(--filter-pad-x) !important; font-size: var(--filter-font) !important;
  border-radius: var(--filter-radius) !important; margin: 0 !important;
  display: inline-flex !important; align-items: center !important;
}

/* ===================== 1) DASHBOARD v2 — tighter filter row ===================== */
section.controls-grid:has(#financial-status-filter) {
  grid-auto-flow: row dense;                                   /* fill holes */
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)) !important;
  column-gap: 6px !important;                                  /* closer chips */
  row-gap: 8px !important;
}
section.controls-grid:has(#financial-status-filter) #column-visibility-button{
  display:inline-flex!important;align-items:center!important;margin:0!important;
  height:var(--filter-h)!important;padding:0 var(--filter-pad-x)!important;
  font-size:var(--filter-font)!important;border-radius:var(--filter-radius)!important;
}

/* ===================== 2) BULK UPDATE — tighter filters + aligned buttons ======= */
.bulk-update-controls .controls-grid{
  grid-auto-flow: row dense;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)) !important;
  column-gap: 6px !important;
  row-gap: 8px !important;
  align-items: center !important;
}
/* chip look + vertical centering for every control in the row */
.bulk-update-controls .controls-grid input[type="search"],
.bulk-update-controls .controls-grid input[type="text"],
.bulk-update-controls .controls-grid input[type="number"],
.bulk-update-controls .controls-grid input[type="date"],
.bulk-update-controls .controls-grid select,
.bulk-update-controls .controls-grid .dropdown > summary,
.bulk-update-controls fieldset label,
.bulk-update-controls #save-changes-btn,
.bulk-update-controls #import-excel-btn,
.bulk-update-controls .import-controls input[type="file"]::file-selector-button{
  height:var(--filter-h)!important;min-height:var(--filter-h)!important;
  display:inline-flex;align-items:center;justify-content:flex-start;
  padding:0 var(--filter-pad-x);font-size:var(--filter-font);border-radius:var(--filter-radius);
}
.bulk-update-controls .control .icon{display:none!important;}
.bulk-update-controls .control input[type="search"]{padding-left:var(--filter-pad-x)!important;}
.bulk-update-controls fieldset{border:0;margin:0;padding:0;}
.bulk-update-controls fieldset label{
  border:1px solid var(--filter-bd);background:var(--filter-bg);
  gap:.5rem;
}
.bulk-update-controls .import-controls{display:inline-flex!important;align-items:center!important;gap:.5rem;}

/* ===================== 3) BULK UPDATE — editable fields +5% only ================ */
#bulk-update-container .bulk-update-table th,
#bulk-update-container .bulk-update-table td{ font-size: inherit !important; } /* reset */
#bulk-update-container .bulk-update-table thead input,
#bulk-update-container .bulk-update-table thead select,
#bulk-update-container .bulk-update-table td input[type="text"],
#bulk-update-container .bulk-update-table td input[type="number"],
#bulk-update-container .bulk-update-table td select,
#bulk-update-container .bulk-update-table [contenteditable="true"]{
  font-size: calc(var(--bu-input-font) * 1.05) !important;
}

/* ===================== 4) BULK UPDATE — 30% smaller images when grouped ========= */
/* robust :has() selectors to catch layout */
:root:has(#group-toggle:checked) #bulk-update-container .bulk-update-table img,
.bulk-update-controls:has(#group-toggle:checked) ~ #bulk-update-container .bulk-update-table img{
  width: calc(var(--bu-thumb) * 0.7) !important;
  height: calc(var(--bu-thumb) * 0.7) !important;
}
