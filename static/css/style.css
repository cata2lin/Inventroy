/* =========================================================
   Inventory Intelligence — Compact, Professional UI
   - Works with Pico CSS v2 (auto light/dark via Pico vars)
   - Preserves your selectors & data-attributes for JS
   - Dense tables, sticky controls, accessible focus rings
   ========================================================= */

/* ------------------ THEME TOKENS (Pico-bridged) ------------------ */
/* Map your custom variables to Pico’s, so light/dark just works. */
:root {
  /* Base colors (semantic) */
  --background-color: var(--pico-background-color, #0b0d10);
  --text-color: var(--pico-color, #e6e8eb);
  --muted-color: var(--pico-muted-color, #8892a0);

  --primary: var(--pico-primary, #0d6efd);
  --primary-inverse: var(--pico-primary-inverse, #ffffff);

  --card-background-color: var(--pico-card-background-color, #101419);
  --card-sectioning-background-color: color-mix(in oklab, var(--card-background-color), #000 6%);
  --card-border-color: var(--pico-card-border-color, #2a3442);

  --border-color: var(--card-border-color);
  --border-radius: var(--pico-border-radius, 12px);

  --box-shadow: var(--pico-box-shadow, 0 6px 20px rgba(0,0,0,.18));
  --focus-ring: 0 0 0 3px color-mix(in oklab, var(--primary), transparent 65%);
}

/* ------------------ BASE LAYOUT ------------------ */
html, body { height: 100%; }
body {
  background-color: var(--background-color);
  color: var(--text-color);
}

/* Focus visibility for keyboard users */
:focus-visible {
  outline: none;
  box-shadow: var(--focus-ring);
  border-radius: calc(var(--border-radius) / 2);
}

/* ------------------ APP SHELL ------------------ */
.app-layout {
  display: grid;
  grid-template-columns: 168px 1fr;
  min-height: 100vh;
}

.sidebar {
  background-color: var(--card-background-color);
  padding: 1.5rem;
  border-right: 1px solid var(--card-border-color);
}

.sidebar nav a {
  display: block;
  padding: 0.75rem;
  border-radius: var(--border-radius);
  margin-bottom: 0.5rem;
  font-weight: 500;
  font-size: 0.75em;
  color: inherit;
  border: 1px solid transparent;
}
.sidebar nav a:hover {
  background-color: var(--card-sectioning-background-color);
  border-color: var(--card-border-color);
}
.sidebar nav a.contrast,
.sidebar nav a.active {
  background-color: var(--primary);
  color: var(--primary-inverse);
}

.main-content {
  padding: 2rem;
  overflow-y: auto;
}

/* Mobile responsive layout */
@media (max-width: 992px) {
  .app-layout { grid-template-columns: 1fr; }
  .sidebar {
    border-right: none;
    border-bottom: 1px solid var(--card-border-color);
    padding: 1rem;
  }
  .main-content { padding: 1rem; }
}

/* ------------------ PAGE WRAPPER ------------------ */
main.container-fluid {
  padding: 1rem 2rem;
  max-width: 100%;
  overflow-x: hidden;
}

/* ------------------ FILTERS & METRICS ------------------ */
.filter-container {
  padding: 0.75rem;
  margin-bottom: 1.5rem;
  background-color: var(--card-background-color);
  border: 1px solid var(--card-border-color);
  border-radius: var(--border-radius);
}

#metrics-container.grid {
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1.5rem;
  margin-bottom: 1rem;
  padding: 0 0.25rem;
}

.metric { text-align: center; }
.metric h4, .metric p { margin: 0; line-height: 1.1; }
.metric h4 { font-size: 1.4rem; font-weight: 600; }
.metric p { font-size: 0.8rem; color: var(--muted-color); }

/* Compact, responsive control grid */
.controls-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
  gap: 0.5rem;
  align-items: center;
}
.controls-grid > *,
.controls-grid details summary,
.controls-grid button {
  font-size: 0.7rem;
  padding: 0.35rem 0.6rem;
  height: auto;
  margin-bottom: 0;
}

/* Sticky control bars */
.sticky-controls {
  position: sticky;
  top: 0;
  z-index: 15;
  background: color-mix(in oklab, var(--card-background-color), transparent 5%);
  border: 1px solid var(--card-border-color);
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
}

/* Dropdown — theme-safe (removed hardcoded dark bg) */
.dropdown[open] > ul {
  position: absolute;
  z-index: 1000;
  top: 100%;
  left: 0;
  margin-top: 0.25rem;
  padding: 0.75rem;
  background: var(--card-background-color) !important;
  border: 1px solid var(--card-border-color);
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  width: max-content;
  min-width: 200px;
  max-height: 300px;
  overflow-y: auto;
}
.dropdown li label { padding: 0.2rem; display: block; }
.dropdown input[type="radio"], .dropdown input[type="checkbox"] { margin-right: 0.5em; }

/* Icon helper (inline SVG) */
.icon { width: 18px; height: 18px; vertical-align: middle; }

/* ------------------ TABLES ------------------ */
#orders-table-container, #inventory-table-container { padding: 0; }
#orders-table-container table, #inventory-table-container table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
}

/* Sticky header with theme background */
#orders-table-container thead th,
#inventory-table-container thead th {
  position: sticky;
  top: 0;
  z-index: 5;
  background: color-mix(in oklab, var(--card-background-color), #000 4%);
  border-bottom: 1px solid var(--card-border-color);
}

/* Dense cell styles */
#orders-table-container th, #orders-table-container td,
#inventory-table-container th, #inventory-table-container td {
  padding: 0.4rem 0.6rem;
  font-size: 0.7rem;
  vertical-align: middle;
  border-bottom: 1px solid var(--card-border-color);
}

/* Sort indicators (kept) */
#orders-table-container th, #inventory-table-container th { white-space: nowrap; cursor: pointer; }
th[data-sort-by] { position: relative; padding-right: 1.5em !important; }
th[data-sort-by].asc::after,
th[data-sort-by].desc::after {
  position: absolute;
  right: 0.5em;
  top: 50%;
  transform: translateY(-50%);
  font-size: 0.8em;
  color: var(--primary);
}
th[data-sort-by].asc::after { content: '▲'; }
th[data-sort-by].desc::after { content: '▼'; }

/* Row interactivity */
#orders-table-container tbody tr:hover,
#inventory-table-container tbody tr:hover {
  background: color-mix(in oklab, var(--card-background-color), #000 4%);
}

/* ------------------ GROUPED LISTS (Inventory & Bulk Update) ------------------ */
.grouped-item {
  background-color: var(--card-background-color);
  border-radius: var(--border-radius);
  margin-bottom: 0.5rem;
  border: 1px solid transparent;
}
.grouped-item[open] { border-color: var(--card-border-color); }
.grouped-item summary { display: block; cursor: pointer; padding: 0.5rem; }
.grouped-item summary > .grid {
  align-items: center;
  grid-template-columns: 60px 3fr 1fr 1fr;
  gap: 1rem;
  min-height: 50px;
}
.grouped-item img { width: 50px; height: 50px; object-fit: cover; border-radius: var(--border-radius); }
.grouped-item .product-info { display: flex; flex-direction: column; }
.grouped-item .variant-details {
  padding: 1rem;
  background-color: var(--card-sectioning-background-color);
  border-radius: 0 0 var(--border-radius) var(--border-radius);
  margin-top: -0.5rem;
}
.quantity-display h2, .quantity-display p { margin: 0; text-align: center; }
.quantity-display h2 { font-size: 1.2rem; }
.quantity-display p { font-size: 0.7rem; color: var(--muted-color); }

/* ------------------ BULK UPDATE ------------------ */
.bulk-update-controls .compact-controls > * {
  font-size: 0.5rem;
  padding: 0.2rem 0.4rem;
  height: auto;
}

.import-controls {
  display: grid;
  grid-template-columns: auto auto;
  gap: 0.5rem;
  margin-top: 1rem;
  align-items: center;
  justify-content: start;
}
.import-controls .bulk-update-action-btn,
.import-controls input[type="file"]::file-selector-button {
  font-size: 0.5rem;
  padding: 0.2rem 0.4rem;
}
.import-controls input[type="file"] {
  font-size: 0.5rem;
  padding: 0;
  width: auto;
}

.bulk-update-table { table-layout: fixed; width: 100%; }
.bulk-update-table th,
.bulk-update-table td {
  height: 28px;
  max-height: 28px;
  padding: 0.1rem 0.4rem;
  vertical-align: middle;
}
.bulk-update-table th { font-size: 0.76em; }

/* Column widths (as provided) */
.bulk-update-table th:nth-child(2), .bulk-update-table td:nth-child(2) { width: 60px; } /* Image */
.bulk-update-table th:nth-child(5), .bulk-update-table td:nth-child(5) { width: 20%; } /* Product Title */
.bulk-update-table th:nth-child(6), .bulk-update-table td:nth-child(6) { width: 12%; } /* Barcode */
.bulk-update-table th:nth-child(8), .bulk-update-table td:nth-child(8) { width: 8%; }  /* Status */
.bulk-update-table th:nth-child(9), .bulk-update-table td:nth-child(9) { width: 5%; }  /* Price */

.bulk-update-table img {
  width: 50px; height: 50px; object-fit: cover; border-radius: var(--border-radius);
}
.bulk-update-table input[type="text"],
.bulk-update-table input[type="number"],
.bulk-update-table select {
  width: 100%;
  height: 70%;
  border: 1px solid transparent;
  background: transparent;
  padding: 0 0.25rem;
  font-size: 0.76em;
  box-sizing: border-box;
}
.bulk-update-table input:focus, .bulk-update-table select:focus {
  border-color: var(--primary);
  background: var(--pico-form-element-background-color, transparent);
}
.bulk-update-table input.changed, .bulk-update-table select.changed {
  background-color: color-mix(in oklab, #ffcc00, transparent 90%);
  font-weight: bold;
}
#bulk-apply-row input { font-size: 0.9em; font-style: italic; }

/* ------------------ COLUMN WIDTH KEYS (Orders) ------------------ */
[data-column-key="order_name"] { width: 9%; }
[data-column-key="store_name"] { width: 10%; }
[data-column-key="created_at"] { width: 8%; }
[data-column-key="total_price"] { width: 9%; }
[data-column-key="financial_status"] { width: 10%; }
[data-column-key="fulfillment_status"] { width: 10%; }
[data-column-key="cancelled"] { width: 12%; }
[data-column-key="note"] { width: 16%; }
[data-column-key="tags"] { width: 16%; }
[data-column-key="hold_reason"] { width: 16%; }

.truncate-text {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ------------------ MODALS, STATUS COLORS, PAGINATION ------------------ */
.column-list { display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; }

.status-paid, .status-fulfilled, .status-active { color: #388e3c; }
.status-pending, .status-partially_fulfilled, .status-draft { color: #f57c00; }
.status-voided, .status-cancelled, .status-archived { color: #546e7a; }
.status-refunded, .status-unfulfilled { color: #d32f2f; }
/* On hold (fix retained) */
.status-on_hold { color: var(--primary); }

/* Pagination layout */
.pagination-controls { display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; }
.pagination-controls > :first-child { justify-self: start; }
.pagination-controls > :last-child { justify-self: end; }
#page-indicator { justify-self: center; }

/* ------------------ UTILS ------------------ */
.table-wrap {
  overflow: auto;
  border-radius: var(--border-radius);
  border: 1px solid var(--card-border-color);
  background: var(--card-background-color);
}

.inline { display: inline-flex; gap: 8px; align-items: center; }

/* Optional toggle pill (if you use it on Inventory) */
.toggle-pill {
  display: inline-flex; align-items: center; gap: 8px; width: fit-content;
}
.toggle-pill input[type="checkbox"] { position: absolute; opacity: 0; width: 1px; height: 1px; }
.toggle-pill .slider {
  position: relative; width: 44px; height: 24px; border-radius: 999px;
  background: var(--card-border-color); transition: background .2s ease;
}
.toggle-pill .slider .knob {
  position: absolute; top: 2px; left: 2px; width: 20px; height: 20px; border-radius: 50%;
  background: var(--card-background-color); box-shadow: 0 1px 3px rgba(0,0,0,.2);
  transition: transform .2s ease;
}
.toggle-pill .slider.on { background: var(--primary); }
.toggle-pill .slider.on .knob { transform: translateX(20px); }

/* ------------------ SMALL SCREENS ------------------ */
@media (max-width: 640px) {
  .controls-grid { grid-template-columns: 1fr 1fr; }
  .cards-grid { grid-template-columns: 1fr; }
}
