{% extends "base.html" %}


{% block content %}
<div class="container-fluid">
<hgroup class="page-header">
<h1>Inventory Report</h1>
<h2>Detailed view of all product variants across all stores.</h2>
</hgroup>


<article class="filter-container">
<!-- Top metrics -->
<section id="metrics-container" class="metrics-grid"></section>


<!-- Controls bar -->
<section class="controls-grid sticky-controls" aria-label="Filters">
<div class="control">
<svg class="icon" aria-hidden="true"><use href="#i-search"/></svg>
<input type="search" id="search-input" placeholder="Search SKU, Barcode, Name..." autocomplete="off">
</div>


<select id="store-filter"><option value="">All Stores</option></select>
<select id="type-filter"><option value="">All Types</option></select>
<select id="category-filter"><option value="">All Categories</option></select>
<select id="status-filter"><option value="">All Statuses</option></select>


<!-- Numeric placeholders (kept for compatibility) -->
<input type="number" id="min-retail-input" placeholder="Min Retail" step="0.01">
<input type="number" id="max-retail-input" placeholder="Max Retail" step="0.01">
<input type="number" id="min-inv-input" placeholder="Min On Hand" step="1">
<input type="number" id="max-inv-input" placeholder="Max On Hand" step="1">


<!-- Group by barcode toggle -->
<label id="group-toggle-wrap" class="toggle-pill">
<input type="checkbox" id="group-toggle" aria-label="Group by barcode">
<span class="slider"></span>
<small>Group by barcode</small>
</label>


<button id="reset-filters" class="secondary outline" type="button" title="Reset all filters">Reset</button>


<!-- Grouped sorting controls (visible only in grouped view; compact) -->
<span id="group-sort-controls" class="group-sort-controls" style="display:none;">
<label class="inline">
<small>Sort</small>
<select id="group-sort-by">
<option value="on_hand">On hand/Total stock</option>
<option value="available">Available</option>
<option value="committed">Committed</option>
<option value="retail_value">Retail value</option>
<option value="inventory_value">Inventory value</option>
<option value="total_stock">Total stock</option>
</select>
</label>
<label class="inline">
<small>Order</small>
<select id="group-sort-order">
<option value="desc">Descending</option>
<option value="asc">Ascending</option>
</select>
</label>
<button id="apply-group-sort" class="secondary" type="button" title="Apply sorting for grouped view">Apply</button>
</span>
</section>
</article>


<!-- Table / Groups container -->
<article id="inventory-table-container" class="table-wrap" aria-busy="true"><p>Loading...</p></article>


<!-- Pagination -->
<div class="grid pagination-controls">
<button id="prev-button" class="secondary outline" disabled><svg class="icon"><use href="#i-left"/></svg> Previous</button>
<span id="page-indicator">Page 1</span>
<button id="next-button" class="secondary outline">Next <svg class="icon"><use href="#i-right"/></svg></button>
</div>


<!-- Details modal (legacy; image click opens dedicated page) -->
<dialog id="details-modal">
<article>
<header>
<button class="close" aria-label="Close" data-target="details-modal"></button>
<strong id="modal-title">Product Details</strong>
</header>
<div id="modal-content" aria-busy="true">
<p>Loading details...</p>
</div>
</article>
</dialog>
</div>
{% endblock %}


{% block scripts %}
<script>
// Slider visual toggle (kept)
(function(){
const wrap = document.getElementById('group-toggle-wrap');
const input = document.getElementById('group-toggle');
const slider = wrap?.querySelector('.slider');
if (!wrap || !input || !slider) return;
const knob = document.createElement('span');
knob.className = 'knob';
slider.appendChild(knob);
const sync = () => {
slider.classList.toggle('on', !!input.checked);
};
input.addEventListener('change', sync);
sync();
})();
</script>
<script src="/static/js/config.js"></script>
<script src="/static/js/inventory.js"></script>
{% endblock %}