{% extends "base.html" %}

{% block content %}
<div class="container-fluid">
    <hgroup class="page-header">
        <h1>Inventory Forecasting</h1>
        <h2>Analyze sales velocity and stock levels to make informed purchasing decisions.</h2>
    </hgroup>

    <article class="filter-container">
        <section class="controls-grid sticky-controls" aria-label="Filters">
            <div class="control">
                <input type="search" id="search-input" placeholder="Search by Title or SKU...">
            </div>
            <details role="list" class="dropdown">
                <summary aria-haspopup="listbox">Stores</summary>
                <ul role="listbox" id="store-filter-list"><li>Loading...</li></ul>
            </details>

            <details role="list" class="dropdown">
                <summary aria-haspopup="listbox">Product Type</summary>
                <ul role="listbox" id="type-filter-list"><li>Loading...</li></ul>
            </details>

            <details role="list" class="dropdown">
                <summary aria-haspopup="listbox">Stock Status</summary>
                <ul role="listbox" id="status-filter-list">
                    <li><label><input type="checkbox" name="status" value="urgent"> Urgent</label></li>
                    <li><label><input type="checkbox" name="status" value="warning"> Warning</label></li>
                    <li><label><input type="checkbox" name="status" value="watch"> Watch</label></li>
                    <li><label><input type="checkbox" name="status" value="healthy"> Healthy</label></li>
                    <li><label><input type="checkbox" name="status" value="overstocked"> Overstocked</label></li>
                    <li><label><input type="checkbox" name="status" value="slow_mover"> Slow Mover</label></li>
                </ul>
            </details>

            <div class="grid">
                <div class="control">
                    <label for="lead-time">Lead Time (days)</label>
                    <input type="number" id="lead-time" value="30">
                </div>
                <div class="control">
                    <label for="coverage-period">Coverage Period (days)</label>
                    <input type="number" id="coverage-period" value="60">
                </div>
            </div>

            <div class="grid">
                <div class="control">
                    <label for="reorder-date-start">Reorder After</label>
                    <input type="date" id="reorder-date-start">
                </div>
                <div class="control">
                    <label for="reorder-date-end">Reorder Before</label>
                    <input type="date" id="reorder-date-end">
                </div>
            </div>
            
            <fieldset id="custom-velocity-controls" class="grid">
                <div class="control">
                    <label for="velocity-metric">Velocity Metric</label>
                    <select id="velocity-metric">
                        <option value="period">Custom Period</option>
                        <option value="lifetime">Lifetime</option>
                    </select>
                </div>
                <div class="grid" id="custom-velocity-dates">
                    <input type="date" id="velocity-start-date" aria-label="Velocity Start Date">
                    <input type="date" id="velocity-end-date" aria-label="Velocity End Date">
                </div>
            </fieldset>

            <div class="controls-end">
                <button id="calculate-lifetime-velocity-btn">Calculate Lifetime Velocity</button>
                <button id="export-button">Export to Excel</button>
            </div>
        </section>
    </article>

    <article id="forecasting-table-container" class="table-wrap" aria-busy="true">
        <p>Loading forecasting data...</p>
    </article>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/config.js"></script>
<script src="/static/js/forecasting.js"></script>
{% endblock %}